"use strict";var R6MMainData=function(){var e={subBasement:{full:"Sub-Basement",short:"SB"},basement:{full:"Basement",short:"B"},firstFloor:{full:"1st Floor",short:"1"},secondFloor:{full:"2nd Floor",short:"2"},thirdFloor:{full:"3rd Floor",short:"3"},fourthFloor:{full:"4th Floor",short:"4"},roof:{full:"Roof",short:"R"}};return{getMapData:function(){return{bank:{name:"Bank",imgUrlPrefix:"bank",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},bartlett:{name:"Bartlett U.",imgUrlPrefix:"bartlett",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},border:{name:"Border",imgUrlPrefix:"border",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},chalet:{name:"Chalet",imgUrlPrefix:"chalet",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},club:{name:"Club House",imgUrlPrefix:"club-house",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},coastline:{name:"Coastline",imgUrlPrefix:"coastline",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},consulate:{name:"Consulate",imgUrlPrefix:"consulate",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},favela:{name:"Favela",imgUrlPrefix:"favela",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.thirdFloor},{index:4,name:e.roof}]},fortress:{name:"Fortress",imgUrlPrefix:"fortress",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},hereford:{name:"Hereford",imgUrlPrefix:"hereford",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.thirdFloor},{index:4,name:e.roof}]},house:{name:"House",imgUrlPrefix:"house",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},kafe:{name:"Kafe Dostoyevsky",imgUrlPrefix:"kafe",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.thirdFloor},{index:4,name:e.roof}]},kanal:{name:"Kanal",imgUrlPrefix:"kanal",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:-1,name:e.subBasement},{index:0,name:e.basement},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},oregon:{name:"Oregon",imgUrlPrefix:"oregon",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.thirdFloor},{index:4,name:e.roof}]},outback:{name:"Outback",imgUrlPrefix:"outback",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},plane:{name:"Plane",imgUrlPrefix:"plane",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.thirdFloor},{index:4,name:e.roof}]},skyscraper:{name:"Skyscraper",imgUrlPrefix:"skyscraper",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},themepark:{name:"Theme Park",imgUrlPrefix:"themepark",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},tower:{name:"Tower",imgUrlPrefix:"tower",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.thirdFloor},{index:4,name:e.roof}]},villa:{name:"Villa",imgUrlPrefix:"villa",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},yacht:{name:"Yacht",imgUrlPrefix:"yacht",floors:[{index:"bg",name:e.basement,top:-1077,left:-1915,dontSelect:!0},{index:1,name:e.firstFloor},{index:2,name:e.secondFloor},{index:3,name:e.thirdFloor},{index:4,name:e.fourthFloor},{index:5,name:e.roof}]}}}}}(),R6MMainRender=function(c,m){var e={WIDTH:2560,HEIGHT:1474,TOP_OFFSET:749,LEFT_OFFSET:1275};c.fn.removeClassPrefix=function(o){return this.each(function(e,n){var t=n.className.split(" ").filter(function(e){return 0!==e.lastIndexOf(o,0)});n.className=c.trim(t.join(" "))}),this};var u={"-1":"neg-one",0:"zero",1:"one",2:"two",3:"three",4:"four",5:"five"},d=function(e){var n="";return"top"in e&&(n+="top: "+e.top+"px;"),"bottom"in e&&(n+="bottom: "+e.bottom+"px;"),"right"in e&&(n+="right: "+e.right+"px;"),"left"in e&&(n+="left: "+e.left+"px;"),"height"in e&&(n+="height: "+e.height+"px;"),"width"in e&&(n+="width: "+e.width+"px;"),"rotate"in e&&(n+="transform: rotate("+e.rotate+"deg);"),n};return{renderMap:function(e,n,t,o){var a="";a+=function(e,n,t){var o="",a=[];e.addClass("loading");var i=c.Deferred(),r="img/"+t+"/"+t+".svg";return o+='<div style="'+d(n[0])+'" class="background"></object>',o+='<img class="inject-me" src="'+r+'"></img>',c("<img/>").attr("src",r).load(function(){c(this).remove(),i.resolve()}),a.push(i),c.when.apply(c,a).then(function(){e.removeClass("loading")}),o}(n,e.floors,e.imgUrlPrefix),t.html(a);var i,r,l,s=m.querySelectorAll("img.inject-me");SVGInjector(s),o.html((i=e.floors,l=r="",i.forEach(function(e){e.dontSelect||(l=u[e.index],r+='<span class="'+l+'">'+e.name.full+"</span>")}),r))},setupMapPanels:function(e,n){for(var t=0;t<n;t++)e.append('<div class="map-wrapper"><div class="helper-border vertical"></div><div class="helper-border horizontal"></div><p class="map-panel-label"></p><div class="map-main"><div class="center-helper"><div class="map-elements"></div><div class="svg-wrapper drawing-markers"></div><div class="svg-wrapper map"></div></div></div></div>')},showFloor:function(e,n,t,o,a){n.attr("selected-floor-index",e);var i=n.attr("map-panel-count");2<i&&(e=Math.max(o,e-1));var r=Math.max(o,a-i+1),l=Math.min(r,e);t.each(function(e,n){c(n).attr("show-floor-index",Math.min(l,a)),l++})},showObjective:function(e,n){var t="show-objective-";n.removeClassPrefix(t),n.addClass(t+e)},SVG_DIM:e}}(window.jQuery,(window,document)),R6MMainControls=function(i,a){function r(){return p.find(".selected").data("index")}function t(n){return function(){var e=h.val();1.6<e?n.addClass(b):e<.4?n.addClass(M):(n.removeClass(b),n.removeClass(M))}}function o(){h.trigger("input")}function l(){return d.val()}function s(e){for(var n=I(e),t=-1;t<5;t++){var o=a.getElementById(t+"-"+e);o.hidden=!o||!n}}function n(){return f.val()}var c,m,u,d=i("#map-control"),f=i("#objective-control"),p=i("#floor-control"),h=i("#zoom-range"),g=i("#mmenu-link"),v=i("#menu-panel"),x="selected",b="zoomed-in-far",M="zoomed-out-far",F=[{short:"bmb",full:"Bomb"},{short:"sec",full:"Secure"},{short:"hst",full:"Hostage"},{short:"fh",full:"Floor hatch"},{short:"ch",full:"Ceiling hatch"},{short:"bw",full:"Breakable wall"},{short:"losw",full:"Line of sight or half wall"},{short:"dt",full:"Drone tunnel"},{short:"losf",full:"Line of sight floor"},{short:"ip",full:"Insertion point"},{short:"cam",full:"Security camera"},{short:"sl",full:"Skylight"},{short:"lad",full:"Ladder"},{short:"cmp",full:"Compass"}],_=function(e){var n=p.find("[data-index='"+e+"']");return!!n.length&&(k(),n.addClass(x),n.trigger("click"),!0)},w=function(e){var n="Shortcut: {shortcut}";return n.replace("{shortcut}",0==e?"'0' or '~'":e)},I=function(e){return i("#option-"+e).is(":checked")},S=function(){return a.fullscreenEnabled||a.webkitFullscreenEnabled||a.webkitCancelFullScreen||a.mozFullScreenEnabled||a.msFullscreenEnabled},E=function(e){return R6MHelpers.trySelectOption(d,e)},k=function(){p.find("."+x).removeClass(x)},R=function(t){p.on("click","button",function(e){var n="SPAN"==e.target.tagName?i(e.target).parent():i(e.target);k(),n.addClass(x),t()})},y=function(e){var t;i(a).on("keydown",(t=e,function(e){var n=e.which;e.key,48<=n&&n<=53?_(n-48)&&t():192==n&&_(0)&&t()}))},e=function(){var e;a.fullscreenElement||a.webkitFullscreenElement||a.webkitCurrentFullScreenElement||a.mozFullScreenElement||a.msFullscreenElement?a.exitFullscreen?a.exitFullscreen():a.webkitExitFullscreen?a.webkitExitFullscreen():a.webkitCancelFullScreen?a.webkitCancelFullScreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.msExitFullscreen&&a.msExitFullscreen():(e=a.documentElement).requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.webkitEnterFullscreen?e.webkitEnterFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()},T=function(e){return R6MHelpers.trySelectOption(f,e)},P=function(e){var n=i("#lock-wrapper");1<e?n.show(600):n.hide(600)},C=function(e,n){e.hasClass("highlighted-item")&&(e.addClass("highlighted-item-in-transition"),setTimeout(function(){e.removeClass("highlighted-item"),setTimeout(function(){e.removeClass("highlighted-item-in-transition")},1800)},n))};return{floors:{get:r,getMinMaxIndex:function(){var e=p.find("button");return{min:i(e[0]).data("index"),max:i(e[e.length-1]).data("index")}},populate:function(e){var n="",t="",o="",a=r();e.forEach(function(e){e.dontSelect||(t="",t+=e.default?x:"",o=w(e.index),n+='<button data-index="'+e.index+'" class="'+t+'" title="'+o+'">',n+='<span class="short">'+e.name.short+"</span>",n+='<span class="full">'+e.name.full+"</span>",n+="</button>")}),p.html(n),_(a)},setup:function(e,n){R(e),y(n)},trySelect:_},mapPanels:{setup:function(t){c.on("change",function(e){var n=c.val();P(n),t(n)})},trySelect:function(e){var n=R6MHelpers.trySelectOption(c,e);return c.trigger("change"),n}},maps:{get:l,populate:function(e){var n="",t=[],o=l();for(var a in e)e.hasOwnProperty(a)&&t.push({key:a,name:e[a].name});t.sort(function(e,n){return e.name<n.name?-1:e.name>n.name?1:0}),t.forEach(function(e){n+='<option value="'+e.key+'">'+e.name+"</option>"}),d.html(n),E(o)},setup:function(e){d.on("change",e)},trySelect:E},menu:{setup:function(){var n,e,t,o="";o+=(n="",e="legend-",n+='<div class="mmenu-custom-panel">',n+="<h2>r6calls.com</h2>",n+='<button id="menu-select-maps">Select a map</button>',n+='<a class="menu-item" id="menu-about" href="about/about.html">About</a>',S()&&(n+='<button href="" id="full-screen">Full screen</button>'),n+="<label>Legend</label>",n+='<ul id="legend"; style="height: 217px;width: 462px; position: relative">',[{class:e+"floor-hatch",description:"Floor hatch"},{class:e+"ceiling-hatch",description:"Ceiling hatch"},{class:e+"breakable-walls",description:"Breakable wall"},{class:e+"line-of-sight-walls",description:"Line of sight or half wall"},{class:e+"drone-tunnels",description:"Drone tunnel"},{class:e+"lineof-sight-floors",description:"Line of sight floor"},{class:e+"insertion-point",description:"Insertion point"},{class:e+"skylight",description:"Skylight"},{class:e+"bomb",description:"Bomb site"},{class:e+"security-camera",description:"Security camera"},{class:e+"secure",description:"Secure site"},{class:e+"ladder",description:"Ladder"},{class:e+"hostage",description:"Hostage site"}].forEach(function(e){n+='<li class="'+e.class+'">'+e.description+"</li>"}),n+="</ul>",n+="</div>"),o+=(t="",t+='<div id="options-wrapper" class="mmenu-custom-panel">',t+="<h2>Options</h2>",t+='<div class="map-panel-count-control">',t+="<label>Number of floors to display</label>",t+='<select id="map-pane-count">',t+='<option value="1">1 - Full</option>',t+='<option value="2">2 - Split</option>',t+='<option value="4">4 - Grid</option>',t+="</select>",t+='<div id="lock-wrapper">',t+='<div class="checkbox-wrapper">',t+='<input type="checkbox" checked="checked" id="option-lp">Lock panning</input>',t+="</div>",t+="</div>",t+="</div>",t+="<label>Elements to display</label>",t+='<div class="checkbox-wrapper">',F.forEach(function(e){t+='<input type="checkbox" checked="checked" id="option-'+e.short+'">'+e.full+"</input><br>"}),t+="</div>",t+="</div>"),o+='<div class="faded-logo"></div>',v.html(o),g.find(".menu-text").html("Menu"),c=i("#map-pane-count"),m=i("#full-screen"),u=i("#menu-select-maps")},setupFullScreen:function(){m&&m.on("click",e)},setupSelectMaps:function(n,t){u.on("click",function(e){e.preventDefault(),n(),t()})},setMenuOption:function(e,n){var t="true"===n;i("#option-"+e).prop("checked",t)},setupMenuOptionChangeEvent:function(n,t){i("#option-"+n).change(function(e){s(n),t(n,I(n))})}},display:{setLayerDisplay:s,MAP_LAYER:F},objectives:{get:n,populate:function(){var e=n();f.html('<option value="bomb">Bomb</option><option value="hostage">Hostage</option><option value="secure">Secure</option><option value="all">Show All</option>'),T(e)},setup:function(e){f.on("change",e)},trySelect:T},pan:{reset:function(e,n){var t=n();e.panzoom("pan",-t.centerLeft*t.zoomValue,-t.centerTop*t.zoomValue)}},zoom:{disable:function(e){e.panzoom("disable")},enable:function(e){e.panzoom("enable")},isZoomed:function(){return 1!=h.val()},reset:function(e,n){var t=n();h.val(t.zoomValue),h.trigger("input")}},highlightControl:function(e){e.addClass("highlighted-item")},removeLatestUpdateHighlight:function(e){C(i("#menu-latest-updates"),e)},setupPanZoom:function(e,n){var a;e.panzoom({$zoomRange:h,minScale:.3,maxScale:2.5}),e.on("mousewheel",function(e){h.val(+h.val()+.06*e.deltaY),h.trigger("input")}),h.on("change",t(n)),h.on("input",t(n)),e.on("touchstart","a",function(e){i(this).addClass("hover")}),e.on("touchend","a",function(e){i(this).removeClass("hover"),this.click()}),e.on("panzoomchange",(a=e,function(t,e,o){I("lp")&&a.each(function(e,n){n!==t.target&&i(n).panzoom("pan",o[4],o[5],{silent:!0})})})),e.on("panzoomend",o)},unhighlightControl:C}}(window.jQuery,(window,document)),MIN_COLUMN_NUM=2,MAX_COLUMN_NUM=10,NATIVE_THUMB_IMG_WIDTH=495,NATIVE_THUMB_IMG_HEIGHT=278,NATIVE_THUMB_IMG_RATIO=NATIVE_THUMB_IMG_WIDTH/NATIVE_THUMB_IMG_HEIGHT,VIEWPORT_PADDING_HEIGHT=10,VIEWPORT_PADDING_WIDTH=15,MAP_LINK_TOTAL_BORDER_SIZE=2,MIN_MAP_LINK_WIDTH=100,THUMB_SCALE_ZOOMED_IN_FACTOR=1.25,R6MMainSelectMaps=function(d,f){function p(e,s,c,m){var u={};return e.forEach(function(e){var n,t,o,a=Math.ceil(s/e),i=Math.floor(c/e),r=Math.floor(m/a),l=i/r;(!u.ratio||Math.abs(NATIVE_THUMB_IMG_RATIO-u.ratio)>Math.abs(NATIVE_THUMB_IMG_RATIO-l))&&MIN_MAP_LINK_WIDTH<=i&&(o=c,n=Math.max(Math.min(Math.floor(o/100),10),20),t=Math.round(n/2),d.extend(u,{_debugColumnCount:e,_debugRowCount:a,_debugAvailableWidth:c,_debugAvailableHeight:m,ratio:l,width:i-MAP_LINK_TOTAL_BORDER_SIZE-2*t,height:r-MAP_LINK_TOTAL_BORDER_SIZE-n,marginVertical:n,marginHorizontal:t}))}),u}function l(e,n,t){var o,a,i={height:d(f).height(),width:d(f).width()},r=t.height(),l=n.length,s=function(e){for(var n,t=[],o=MIN_COLUMN_NUM;o<=MAX_COLUMN_NUM;o++)(o<=2*(n=e%o)||o-n<3)&&t.push(o);return t}(l),c=p(s,l,i.width-VIEWPORT_PADDING_WIDTH,i.height-r-VIEWPORT_PADDING_HEIGHT),m=(a=c,Math.max(a.height/(NATIVE_THUMB_IMG_HEIGHT-1),a.width/(NATIVE_THUMB_IMG_WIDTH-1))),u=n.find(".spinner");e.css("padding-top",r+VIEWPORT_PADDING_HEIGHT+"px"),n.height(c.height),n.width(c.width),n.css("margin","0 "+c.marginHorizontal+"px "+c.marginVertical+"px "+c.marginHorizontal+"px"),u.css("background-size",Math.min(c.height,c.width)-20+"px"),(o=navigator&&("Microsoft Internet Explorer"==navigator.appName||"Netscape"==navigator.appName&&0<navigator.appVersion.indexOf("Trident")))||h(n.find("div.image.thumb"),m),n.hover(function(e){o||h(d(e.target).closest("li").find("div.image.thumb"),m*THUMB_SCALE_ZOOMED_IN_FACTOR)},function(e){o||h(d(e.target).closest("li").find("div.image.thumb"),m)})}var h=function(e,n){e.css("-ms-transform","scale("+n+")"),e.css("-webkit-transform","scale("+n+")"),e.css("transform","scale("+n+")")};return{setup:function(e,n,t,o,a,i){n.text("Select a map"),e.html(function(e){var n=[],t="<ul>";for(var o in e)e.hasOwnProperty(o)&&n.push({key:o,name:e[o].name});return n.sort(function(e,n){return e.name<n.name?-1:e.name>n.name?1:0}),n.forEach(function(e){t+='<li data-key="'+e.key+'">',t+='<a href="" class="'+e.key+'">',t+='<div class="wrapper absolute thumb"><div class="image thumb"></div></div>',t+='<div class="wrapper absolute spinner loading"><div>',t+="</div></div>",t+="<p>"+e.name+"</p>",t+="</a>",t+="</li>"}),t+="</ul>"}(o)),e.on("click","a",function(e){e.preventDefault(),a(d(e.target).closest("li").data("key"))}),e.on("click",i);function r(){l(e,e.find("a"),t,e.find("ul"))}r(),d(f).on("resize",r),setTimeout(function(){e.addClass("enable-thumb-transition")},1),d("<img/>").attr("src","img/map-thumbs.jpg").load(function(){d(this).remove(),e.find(".spinner").removeClass("loading")})}}}(window.jQuery,window,document),PING_MARKER_RADIUS=10,MIN_PING_MARKER_RADIUS=7,MAX_PING_MARKER_RADIUS=16,PING_MARKER_BORDER_PERCENT=.2,MIN_PING_MARKER_BORDER=1,refreshPings=function(){},R6MMainDrawing=function(y){var T=function(e,n,t){var o=t.offset().left+t.width()/2,a=t.offset().top+t.height()/2,i=t.find(".map-main").panzoom("getMatrix"),r=parseInt(i[4]),l=parseInt(i[5]),s=i[0];return{x:Math.round((e-o-r)/s),y:Math.round((n-a-l)/s)}},P=function(e,n,t,o,a,i,r,l){e.attr("cx",i),e.attr("cy",r),n.attr("cx",i),n.attr("cy",r),t.attr("x1",i),t.attr("x2",i),o.attr("y1",r),o.attr("y2",r),(refreshPings=function(){y.each(a,function(e,n){var t=y(n),o=t.closest(".map-wrapper").attr("show-floor-index");l&&l!=o?l<o?t.attr("transform","translate("+(i-9)+" "+(r-5)+"), rotate(0)"):t.attr("transform","translate("+(i+9)+" "+(r+5)+"), rotate(180)"):t.attr("transform","translate(-10000 -10000)")}),y.each(e,function(e,n){var t=y(n),o=t.closest(".map-wrapper").attr("show-floor-index");l&&l!=o?t.addClass("other-floor"):t.removeClass("other-floor")})})(),e.addClass("highlight"),n.addClass("highlight"),t.addClass("highlight"),o.addClass("highlight"),setTimeout(function(){e.removeClass("highlight"),n.removeClass("highlight"),t.removeClass("highlight"),o.removeClass("highlight")},100)};return{setup:function(e,n,t){var o,a,i;o=n,i="",i+='<svg class="svg-elements drawing-markers" style="width: '+(a=t).WIDTH+"px; left: -"+a.LEFT_OFFSET+"px; height: "+a.HEIGHT+"px; top: -"+a.TOP_OFFSET+'px;">',i+="<g>",i+='<line class="ping-marker vertical" x1="-9000" y1="35" x2="-10000" y2="'+(a.HEIGHT+35)+'" stroke-width="2"/>',i+='<line class="ping-marker horizontal" x1="-25" y1="-10000" x2="'+(a.WIDTH-25)+'" y2="-9000" stroke-width="2"/>',i+='<circle class="ping-marker accent" cx="-10000" cy="-10000" r="6" stroke-width="2"/>',i+='<circle class="ping-marker center" cx="-10000" cy="-10000" r="6" stroke-width="2"/>',i+='<polygon class="ping-marker other-floor" points="0,0 18,0 9,15.5884" stroke-width="2" transform="translate(-10000 -10000)"></polygon>',i+="</g>",i+="</svg>",o.html(i);var r,l,s,c,m,u,d,f,p,h,g,v,x,b,M,F=n.find(".ping-marker.center"),_=n.find(".ping-marker.accent"),w=n.find(".ping-marker.vertical"),I=n.find(".ping-marker.horizontal"),S=n.find(".ping-marker.other-floor"),E=(M=t,function(e){var n=y(e.target).closest(".map-wrapper"),t=T(e.center.x,e.center.y,n),o=t.x,a=t.y,i=n.attr("show-floor-index");P(h,g,v,x,b,o+M.LEFT_OFFSET,a+M.TOP_OFFSET,i)}),k=function(){var e=y(f[0]).panzoom("getMatrix")[0],n=Math.round(PING_MARKER_RADIUS/e),n=Math.max(MIN_PING_MARKER_RADIUS,n),n=Math.min(MAX_PING_MARKER_RADIUS,n),t=Math.max(MIN_PING_MARKER_BORDER,Math.floor(n*PING_MARKER_BORDER_PERCENT));n-=t,u.attr("r",n),d.attr("r",2*n),u.attr("stroke-width",t),p.attr("stroke-width",t)},R=(r=u=h=F,l=d=g=_,s=v=w,c=x=I,m=p=b=S,function(){P(r,l,s,c,m,-1e4,-1e4)});(f=e).each(function(e,n){var t=new Hammer(n);t.on("press",E),t.on("tap",E)}),F.on("click",R),e.on("panzoomzoom",k),k()},refreshPings:function(){refreshPings()}}}(window.jQuery,(window,document));!function(o,a,i,r,l,s,c,n){var d,m,u,f,p,h,g,t,v,x="show-map",b="show-select-map",M="/";o(function(){W();l.setupMapPanels(m,4);e();Q();Y();s.maps.populate(r.getMapData());K();g.on("click",ee);ae();s.setupPanZoom(u,f);if(ie()){N();re();le();Z()}else{q();i.title="R6Calls.com"}setTimeout(function(){t.removeClass("loading")},10)});var F=function e(){return t.attr("loaded-map")},_=function e(){E().close()},w=function e(){return t.hasClass(x)},I=function e(){return a.location.hash.substr(1).split(M)},S=function e(){return o("body").attr("loaded-map")},E=function e(){return o("#mmenu-menu").data("mmenu")},k=function e(){var n={topLeft:{top:-180,left:-312},bottomRight:{top:180,left:312}};var t=n.bottomRight.left-n.topLeft.left,o=n.bottomRight.top-n.topLeft.top,a=Math.round(n.bottomRight.top-o/2),i=Math.round(n.topLeft.left+t/2),r=d.width(),l=d.height(),s=v.height(),c=Math.min(l*.1,s),m=Math.min(l*.1,s*2);r=r-c;l=l-m;var u={debugZoomWidth:t,debugZoomHeight:o,centerTop:a,centerLeft:i,debugPanelWidth:r,debugPanelHeight:l,debugPaddingWidth:c,debugPaddingHeight:m,zoomValue:Math.max(Math.min(1,r/t,l/o),.5)};return u},R=function e(){z();X();se();c.refreshPings()},y=function e(){G();N();se()},T=function e(n){L(n);j(n)},P=function e(n){var t=E();n.preventDefault();t.open();s.removeLatestUpdateHighlight(200)},C=function e(){B();$();se()},A=function e(){t.removeClass(b)},H=function e(n,t){try{localStorage.setItem(n,t)}catch(e){}},N=function e(){var n=s.maps.get(),t=r.getMapData();s.objectives.populate(["bomb","hostage","secure"]);s.floors.populate(t[n].floors);l.renderMap(t[n],d,f,p);s.pan.reset(u,k);s.zoom.reset(u,k);X();$();V(n);g.addClass("enabled");ce();c.setup(u,h,l.SVG_DIM)},D=function e(){var n,t,o=a.location;if("pushState"in history){history.pushState("",i.title,o.pathname+o.search)}else{n=i.body.scrollTop;t=i.body.scrollLeft;o.hash="";i.body.scrollTop=n;i.body.scrollLeft=t}},O=function e(n,t){H(n,t);if(t){s.pan.reset(u,k)}},U=function e(n,t){ga("send",{hitType:"event",eventCategory:"Controls",eventAction:n,eventLabel:t})},z=function e(){U("Floor",s.floors.get())},L=function e(n){U("PanelsCount",n)},G=function e(){U("Map",s.maps.get())},B=function e(){U("Objective",s.objectives.get())},V=function e(n){t.attr("loaded-map",n)},e=function e(){d=o(".map-wrapper");u=d.find(".map-main");f=u.find(".map-elements");p=o(".map-panel-label");h=u.find(".svg-wrapper.drawing-markers")},j=function e(t){H("mappanelcount",t);m.attr("map-panel-count",t);o.each(u,function(e,n){if(e<t){o(n).css("display","block");s.zoom.enable(o(n))}else{o(n).css("display","none");s.zoom.disable(o(n))}});s.pan.reset(u,k);s.zoom.reset(u,k);X()},W=function e(){m=o("#map-panel-wrapper");g=o("#nav-logo");t=o("body");v=o("#main-nav")},K=function e(){s.objectives.setup(C);s.maps.setup(y);s.floors.setup(R,X);s.mapPanels.setup(T);s.display.MAP_LAYER.forEach(function(e){s.menu.setupMenuOptionChangeEvent(e.short,O)});s.menu.setupMenuOptionChangeEvent("lp",O);s.menu.setupSelectMaps(q,_);s.menu.setupFullScreen();o(a).on("orientationchange",function(){s.pan.reset(u,k);s.zoom.reset(u,k)})},Z=function e(){A();t.addClass(x);se();ce()},q=function e(){t.removeClass(x);t.addClass(b);se();ce()},Q=function e(){var n=o("#mmenu-link");s.menu.setup();var t=o("#mmenu-menu").mmenu({offCanvas:{position:"right",pageSelector:"#mmenu-page"},extensions:["pagedim"],rtl:{use:false}});n.click(P)},Y=function e(){n.setup(o("#select-map-grid"),o("#select-map-heading"),v,r.getMapData(),J,ne)},X=function e(){var n=s.floors.getMinMaxIndex();l.showFloor(s.floors.get(),m,d,n.min,n.max)},$=function e(){l.showObjective(s.objectives.get(),f)},J=function e(n){if(s.maps.trySelect(n)){A();setTimeout(function(){N();Z()},1)}},ee=function e(n){var t=E();n.preventDefault();if(w()){q();t.close()}else if(F()){Z();t.close()}},ne=function e(){if(F()){Z()}},te=function e(n){var t=localStorage.getItem(n);if(t!==null){s.menu.setMenuOption(n,t)}},oe=function e(){var n=localStorage.getItem("mappanelcount");if(!n){var t=o(a);n=t.width()>1e3||t.height()>1e3?2:1}s.mapPanels.trySelect(n);j(n)},ae=function e(){oe();s.display.MAP_LAYER.forEach(function(e){te(e.short)});te("lp")},ie=function e(){var n=I(),t=n[0];return s.maps.trySelect(t)},re=function e(){var n=I(),t=n[2];if(s.objectives.trySelect(t)){$()}},le=function e(){var n=I(),t=n[1];if(s.floors.trySelect(t)){X()}},se=function e(){if(w()){var n="";n+=""+s.maps.get();n+=M+s.floors.get();n+=M+s.objectives.get();a.location.hash=n}else{D()}},ce=function e(){i.title=w()?"R6Calls.com - {mapName}".replace("{mapName}",r.getMapData()[S()].name):"R6Calls.com - Select a map"}}(window.jQuery,window,document,R6MMainData,R6MMainRender,R6MMainControls,R6MMainDrawing,R6MMainSelectMaps,R6MHelpers);
//# sourceMappingURL=main.min.js.map