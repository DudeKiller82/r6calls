"use strict";var R6MMainData=function(){var e={subBasement:{full:"Sub-Basement",short:"SB"},basement:{full:"Basement",short:"B"},firstFloor:{full:"1st Floor",short:"1"},secondFloor:{full:"2nd Floor",short:"2"},thirdFloor:{full:"3rd Floor",short:"3"},fourthFloor:{full:"4th Floor",short:"4"},roof:{full:"Roof",short:"R"}};return{getMapData:function(){return{bank:{name:"Bank",imgUrlPrefix:"bank",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},bartlett:{name:"Bartlett U.",imgUrlPrefix:"bartlett",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},border:{name:"Border",imgUrlPrefix:"border",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},chalet:{name:"Chalet",imgUrlPrefix:"chalet",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},club:{name:"Club House",imgUrlPrefix:"club-house",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},coastline:{name:"Coastline",imgUrlPrefix:"coastline",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},consulate:{name:"Consulate",imgUrlPrefix:"consulate",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},favela:{name:"Favela",imgUrlPrefix:"favela",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.thirdFloor},{index:4,name:e.roof}]},fortress:{name:"Fortress",imgUrlPrefix:"fortress",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},hereford:{name:"Hereford",imgUrlPrefix:"hereford",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.thirdFloor},{index:4,name:e.roof}]},house:{name:"House",imgUrlPrefix:"house",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},kafe:{name:"Kafe Dostoyevsky",imgUrlPrefix:"kafe",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.thirdFloor},{index:4,name:e.roof}]},kanal:{name:"Kanal",imgUrlPrefix:"kanal",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:-1,name:e.subBasement},{index:0,name:e.basement},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},oregon:{name:"Oregon",imgUrlPrefix:"oregon",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.thirdFloor},{index:4,name:e.roof}]},outback:{name:"Outback",imgUrlPrefix:"outback",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},plane:{name:"Plane",imgUrlPrefix:"plane",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.thirdFloor},{index:4,name:e.roof}]},skyscraper:{name:"Skyscraper",imgUrlPrefix:"skyscraper",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},themepark:{name:"Theme Park",imgUrlPrefix:"themepark",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},tower:{name:"Tower",imgUrlPrefix:"tower",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.thirdFloor},{index:4,name:e.fourthFloor},{index:5,name:e.roof}]},villa:{name:"Villa",imgUrlPrefix:"villa",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:0,name:e.basement},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.roof}]},yacht:{name:"Yacht",imgUrlPrefix:"yacht",floors:[{index:"bg",name:e.basement,dontSelect:!0},{index:1,name:e.firstFloor,default:!0},{index:2,name:e.secondFloor},{index:3,name:e.thirdFloor},{index:4,name:e.fourthFloor},{index:5,name:e.roof}]}}}}}(),R6MMainRender=function(s){var e={WIDTH:1e5,HEIGHT:1e5,TOP_OFFSET:50012,LEFT_OFFSET:49995};s.fn.removeClassPrefix=function(o){return this.each(function(e,n){var t=n.className.split(" ").filter(function(e){return 0!==e.lastIndexOf(o,0)});n.className=s.trim(t.join(" "))}),this};var c={"-1":"neg-one",0:"zero",1:"one",2:"two",3:"three",4:"four",5:"five"};return{getMapHTML:function(e,n,t){var o,a,r,i,l,s="";s+=(e.floors,o=e.imgUrlPrefix,a="",a+='<div class="background loading">',a+='<object class="svgMap" data="img/maps/'+o+'.svg" type="image/svg+xml" style="visibility: hidden; top: -250px; left: -250px; height: 500px; width: 500px"></object>',a+="</div>"),n.html(s),t.html((r=e.floors,l=i="",r.forEach(function(e){e.dontSelect||(l=c[e.index],i+='<span class="'+l+'">'+e.name.full+"</span>")}),i))},createMapPanels:function(e,n){for(var t=0;t<n;t++)e.append('<div class="map-container"><div class="helper-border vertical"></div><div class="helper-border horizontal"></div><p class="map-panel-label"></p><div class="map-main"><div class="center-helper"><div class="map-elements"></div><div class="svg-wrapper drawing-markers"></div><div class="svg-wrapper map"></div></div></div></div>')},showFloor:function(e,n,t,o,a){n.attr("selected-floor-index",e);var r=n.attr("map-panels-count");2<r&&(e=Math.max(o,e-1));var i=Math.max(o,a-r+1),l=Math.min(i,e);t.each(function(e,n){s(n).attr("show-floor-index",Math.min(l,a)),l++})},showObjective:function(e,n){var t="show-objective-";n.removeClassPrefix(t),n.addClass(t+e)},SVG_DIM:e}}(window.jQuery,(window,document)),R6MMainControls=function(d,u){function r(){return g.find(".selected").data("index")}function f(){var e=g.find("button");return{min:d(e[0]).data("index"),max:d(e[e.length-1]).data("index")}}function t(n){return function(){var e=x.val();1.6<e?n.addClass(F):e<.4?n.addClass(E):(n.removeClass(F),n.removeClass(E))}}function o(){x.trigger("input")}function i(){return p.val()}function a(e,n){var t=e.find('option[value="'+n+'"]');return!!t.length&&(t.prop("selected",!0),!0)}function l(e){for(var n,t=I(e),o=u.getElementsByClassName("svgMap"),a=0;a<o.length;a++){var r=o[a].getSVGDocument();if(r)for(n=-2;n<5;n++){var i=r.getElementById(n+"-"+e);-2==n&&(i=r.getElementById("bg-"+e)),i&&(i.style.display=t?"inline":"none")}}}function s(e){var n,t=f(),o=u.getElementsByClassName("svgMap"),a=e,r=d("#map-panels-container").attr("map-panels-count");2<r&&(a=Math.max(t.min,a-1));for(var i=Math.max(t.min,t.max-r+1),l=Math.min(i,a),s=0;s<o.length;s++){var c=o[s].getSVGDocument();if(c)for(n=-1;n<5;n++){var m=c.getElementById("Floor "+n);m&&(m.style.display=n==l?"inline":"none")}l++}}var c,m,h,p=d("#map-control"),g=d("#floor-control"),x=d("#zoom-range"),v=d("#mmenu-link"),b=d("#menu-panel"),M="selected",F="zoomed-in-far",E="zoomed-out-far",_=[{short:"bmb",full:"Bomb"},{short:"sec",full:"Secure"},{short:"hst",full:"Hostage"},{short:"fh",full:"Floor hatch"},{short:"ch",full:"Ceiling hatch"},{short:"bw",full:"Breakable wall"},{short:"losf",full:"Line of sight floor"},{short:"sl",full:"Skylight"},{short:"dt",full:"Drone tunnel"},{short:"cam",full:"Security camera"},{short:"ld",full:"Ladder"},{short:"ip",full:"Insertion point"},{short:"txt",full:"Label"},{short:"cmp",full:"Compass"},{short:"lg",full:"Legend"}],S=function(e){var n=g.find("[data-index='"+e+"']");return!!n.length&&(P(),n.addClass(M),n.trigger("click"),!0)},k=function(e){var n="Shortcut: {shortcut}";return n.replace("{shortcut}",0==e?"'0' or '~'":e)},I=function(e){return d("#option-"+e).is(":checked")},w=function(){return u.fullscreenEnabled||u.webkitFullscreenEnabled||u.webkitCancelFullScreen||u.mozFullScreenEnabled||u.msFullscreenEnabled},y=function(e){return a(p,e)},P=function(){g.find("."+M).removeClass(M)},C=function(t){g.on("click","button",function(e){var n="SPAN"==e.target.tagName?d(e.target).parent():d(e.target);P(),n.addClass(M),s(e.currentTarget.getAttribute("data-index")),t()})},T=function(e){var t;d(u).on("keydown",(t=e,function(e){var n=e.which;48<=n&&n<=53?S(n-48)&&t():192==n&&S(0)&&t()}))},e=function(){var e;u.fullscreenElement||u.webkitFullscreenElement||u.webkitCurrentFullScreenElement||u.mozFullScreenElement||u.msFullscreenElement?u.exitFullscreen?u.exitFullscreen():u.webkitExitFullscreen?u.webkitExitFullscreen():u.webkitCancelFullScreen?u.webkitCancelFullScreen():u.mozCancelFullScreen?u.mozCancelFullScreen():u.msExitFullscreen&&u.msExitFullscreen():(e=u.documentElement).requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.webkitEnterFullscreen?e.webkitEnterFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()},R=function(e){var n=d("#lock-container");1<e?n.show(600):n.hide(600)};return{getSelectedFloor:r,getMinMaxFloor:f,getFloorButtonsHTML:function(e){var n="",t="",o="",a=r();e.forEach(function(e){e.dontSelect||(t="",t+=e.default?M:"",o=k(e.index),n+='<button data-index="'+e.index+'" class="'+t+'" title="'+o+'">',n+='<span class="short">'+e.name.short+"</span>",n+='<span class="full">'+e.name.full+"</span>",n+="</button>")}),g.html(n),S(a)},setFloorsChangeEventAndHotkeys:function(e,n){C(e),T(n)},setSelectedFloor:S,setMapPanelsCountChangeEvent:function(t){c.on("change",function(e){var n=c.val();R(n),t(n)})},setSelectedMapPanel:function(e){var n=a(c,e);return c.trigger("change"),n},getSelectedMap:i,createMapCombo:function(e){var n="",t=[],o=i();for(var a in e)e.hasOwnProperty(a)&&t.push({key:a,name:e[a].name});t.sort(function(e,n){return e.name<n.name?-1:e.name>n.name?1:0}),t.forEach(function(e){n+='<option value="'+e.key+'">'+e.name+"</option>"}),p.html(n),y(o)},setMapChangeEvent:function(e){p.on("change",e)},setSelectedMap:y,getMenuHTML:function(){var e,n,t="";t+=(e="",e+='<div class="mmenu-custom-panel">',e+="<h2>r6calls.com</h2>",e+='<button id="menu-map-selection">Select a map</button>',e+="<br>",w()&&(e+='<button href="" id="full-screen">Full screen</button>',e+="<br>"),e+='<a class="menu-item" id="menu-about" href="about/about.html">About</a>',e+="</div>"),t+=(n="",n+='<div id="options-wrapper" class="mmenu-custom-panel">',n+="<h2>Options</h2>",n+='<div class="map-panels-count-control">',n+="<label>Number of floors to display:</label>",n+='<select id="map-pane-count">',n+='<option value="1">1 - Full</option>',n+='<option value="2">2 - Split</option>',n+='<option value="4">4 - Grid</option>',n+="</select>",n+='<div id="lock-container">',n+='<div class="checkbox-wrapper">',n+='<input type="checkbox" checked="checked" id="option-lfa">Lock floor alignment</input>',n+="</div>",n+="</div>",n+="</div>",n+="<label>Elements to display:</label>",n+='<div class="checkbox-wrapper">',_.forEach(function(e){n+='<div class="checkbox-item">',n+='<img class="legend-icon" src="./img/legend/'+e.short+'.png"><input type="checkbox" checked="checked" id="option-'+e.short+'">'+e.full+"</input><br>",n+="</div>"}),n+="</div>",n+="</div>"),t+='<div class="faded-logo"></div>',b.html(t),v.find(".menu-text").html("Menu"),c=d("#map-pane-count"),m=d("#full-screen"),h=d("#menu-map-selection")},setMenuFullScreenClickEvent:function(){m&&m.on("click",e)},setMenuSelectMapClickEvent:function(n,t){h.on("click",function(e){e.preventDefault(),n(),t()})},setMenuCheckboxOption:function(e,n){var t="true"===n;d("#option-"+e).prop("checked",t)},setMenuCheckboxChangeEvent:function(n,t){d("#option-"+n).change(function(e){l(n),t(n,I(n))})},setLayerDisplay:l,setFoorDisplay:s,setMapsPositionAndSize:function(){for(var e=u.getElementsByClassName("svgMap"),n=0;n<e.length;n++){var t,o,a,r,i,l=e[n].getSVGDocument();l&&(o=-1*(t=l.getElementById("mainSVG")).getAttribute("height")/2,a=-1*t.getAttribute("width")/2,r=t.getAttribute("height"),i=t.getAttribute("width"),e[n].parentElement.style.top=o+"px",e[n].parentElement.style.left=a+"px",e[n].parentElement.style.height=r+"px",e[n].parentElement.style.width=i+"px",e[n].style.top=o+"px",e[n].style.left=a+"px",e[n].style.height=r+"px",e[n].style.width=i+"px")}},removeHidden:function(e){var n=u.getElementsByClassName("svgMap");for(e=0;e<n.length;e++)n[e].style.visibility="visible"},MAP_LAYERS:_,resetPan:function(e,n){var t=n();e.panzoom("pan",-t.centerLeft*t.zoomValue,-t.centerTop*t.zoomValue)},disableZoom:function(e){e.panzoom("disable")},enableZoom:function(e){e.panzoom("enable")},isZoomed:function(){return 1!=x.val()},resetZoom:function(e,n){var t=n();x.val(t.zoomValue),x.trigger("input")},setPanZoom:function(e,n){var a;e.panzoom({$zoomRange:x,minScale:.3,maxScale:2.5}),e.on("mousewheel",function(e){x.val(+x.val()+.06*e.deltaY),x.trigger("input")}),x.on("change",t(n)),x.on("input",t(n)),e.on("touchstart","a",function(e){d(this).addClass("hover")}),e.on("touchend","a",function(e){d(this).removeClass("hover"),this.click()}),e.on("panzoomchange",(a=e,function(t,e,o){I("lfa")&&a.each(function(e,n){n!==t.target&&d(n).panzoom("pan",o[4],o[5],{silent:!0})})})),e.on("panzoomend",o)}}}(window.jQuery,(window,document)),MIN_COLUMN_NUM=2,MAX_COLUMN_NUM=10,NATIVE_THUMB_IMG_WIDTH=495,NATIVE_THUMB_IMG_HEIGHT=278,NATIVE_THUMB_IMG_RATIO=NATIVE_THUMB_IMG_WIDTH/NATIVE_THUMB_IMG_HEIGHT,VIEWPORT_PADDING_HEIGHT=10,VIEWPORT_PADDING_WIDTH=15,MAP_LINK_TOTAL_BORDER_SIZE=2,MIN_MAP_LINK_WIDTH=100,THUMB_SCALE_ZOOMED_IN_FACTOR=1.25,R6MMainMapSelectionGrid=function(u,d){function f(e,s,c,m){var d={};return e.forEach(function(e){var n,t,o,a=Math.ceil(s/e),r=Math.floor(c/e),i=Math.floor(m/a),l=r/i;(!d.ratio||Math.abs(NATIVE_THUMB_IMG_RATIO-d.ratio)>Math.abs(NATIVE_THUMB_IMG_RATIO-l))&&MIN_MAP_LINK_WIDTH<=r&&(o=c,n=Math.max(Math.min(Math.floor(o/100),10),20),t=Math.round(n/2),u.extend(d,{_debugColumnCount:e,_debugRowCount:a,_debugAvailableWidth:c,_debugAvailableHeight:m,ratio:l,width:r-MAP_LINK_TOTAL_BORDER_SIZE-2*t,height:i-MAP_LINK_TOTAL_BORDER_SIZE-n,marginVertical:n,marginHorizontal:t}))}),d}function l(e,n,t){var o,a={height:u(d).height(),width:u(d).width()},r=t.height(),i=n.length,l=function(e){for(var n,t=[],o=MIN_COLUMN_NUM;o<=MAX_COLUMN_NUM;o++)(o<=2*(n=e%o)||o-n<3)&&t.push(o);return t}(i),s=f(l,i,a.width-VIEWPORT_PADDING_WIDTH,a.height-r-VIEWPORT_PADDING_HEIGHT),c=(o=s,Math.max(o.height/(NATIVE_THUMB_IMG_HEIGHT-1),o.width/(NATIVE_THUMB_IMG_WIDTH-1))),m=n.find(".spinner");e.css("padding-top",r+VIEWPORT_PADDING_HEIGHT+"px"),n.height(s.height),n.width(s.width),n.css("margin","0 "+s.marginHorizontal+"px "+s.marginVertical+"px "+s.marginHorizontal+"px"),m.css("background-size",Math.min(s.height,s.width)-20+"px"),h(n.find("div.image.thumb"),c),n.hover(function(e){h(u(e.target).closest("li").find("div.image.thumb"),c*THUMB_SCALE_ZOOMED_IN_FACTOR)},function(e){h(u(e.target).closest("li").find("div.image.thumb"),c)})}var h=function(e,n){e.css("-ms-transform","scale("+n+")"),e.css("-webkit-transform","scale("+n+")"),e.css("transform","scale("+n+")")};return{createMapSelectionGrid:function(e,n,t,o,a,r){n.text("Select a map"),e.html(function(e){var n=[],t="<ul>";for(var o in e)e.hasOwnProperty(o)&&n.push({key:o,name:e[o].name,imgUrlPrefix:e[o].imgUrlPrefix});return n.sort(function(e,n){return e.name<n.name?-1:e.name>n.name?1:0}),n.forEach(function(e){t+='<li data-key="'+e.key+'">',t+='<a href="" class="'+e.key+'">',t+='<div class="wrapper absolute thumb"><div class="image thumb" style="background-image: url(./img/thumbnails/'+e.imgUrlPrefix+'.webp);"></div></div>',t+='<div class="wrapper absolute spinner loading"><div>',t+="</div></div>",t+="<p>"+e.name+"</p>",t+="</a>",t+="</li>"}),t+="</ul>"}(o)),e.on("click","a",function(e){e.preventDefault(),a(u(e.target).closest("li").data("key"))}),e.on("click",r);function i(){l(e,e.find("a"),t)}i(),u(d).on("resize",i),setTimeout(function(){e.addClass("enable-thumb-transition")},1)}}}(window.jQuery,window,document),PING_MARKER_RADIUS=10,MIN_PING_MARKER_RADIUS=7,MAX_PING_MARKER_RADIUS=16,PING_MARKER_BORDER_PERCENT=.2,MIN_PING_MARKER_BORDER=1,refreshPings=function(){},R6MMainDrawing=function(P){var C=function(e,n,t){var o=t.offset().left+t.width()/2,a=t.offset().top+t.height()/2,r=t.find(".map-main").panzoom("getMatrix"),i=parseInt(r[4]),l=parseInt(r[5]),s=r[0];return{x:Math.round((e-o-i)/s),y:Math.round((n-a-l)/s)}},T=function(e,n,t,o,a,r,i,l){e.attr("cx",r),e.attr("cy",i),n.attr("cx",r),n.attr("cy",i),t.attr("x1",r),t.attr("x2",r),o.attr("y1",i),o.attr("y2",i),(refreshPings=function(){P.each(a,function(e,n){var t=P(n),o=t.closest(".map-container").attr("show-floor-index");l&&l!=o?l<o?t.attr("transform","translate("+(r-9)+" "+(i-5)+"), rotate(0)"):t.attr("transform","translate("+(r+9)+" "+(i+5)+"), rotate(180)"):t.attr("transform","translate(-10000 -10000)")}),P.each(e,function(e,n){var t=P(n),o=t.closest(".map-container").attr("show-floor-index");l&&l!=o?t.addClass("other-floor"):t.removeClass("other-floor")})})(),e.addClass("highlight"),n.addClass("highlight"),t.addClass("highlight"),o.addClass("highlight"),setTimeout(function(){e.removeClass("highlight"),n.removeClass("highlight"),t.removeClass("highlight"),o.removeClass("highlight")},100)};return{setupMarkers:function(e,n,t){var o,a,r;o=n,r="",r+='<svg class="svg-elements drawing-markers" style="width: '+(a=t).WIDTH+"px; left: -"+a.LEFT_OFFSET+"px; height: "+a.HEIGHT+"px; top: -"+a.TOP_OFFSET+'px;">',r+="<g>",r+='<line class="ping-marker vertical" x1="-9000" y1="35" x2="-10000" y2="'+(a.HEIGHT+35)+'" stroke-width="2"/>',r+='<line class="ping-marker horizontal" x1="-25" y1="-10000" x2="'+(a.WIDTH-25)+'" y2="-9000" stroke-width="2"/>',r+='<circle class="ping-marker accent" cx="-10000" cy="-10000" r="6" stroke-width="2"/>',r+='<circle class="ping-marker center" cx="-10000" cy="-10000" r="6" stroke-width="2"/>',r+='<polygon class="ping-marker other-floor" points="0,0 18,0 9,15.5884" stroke-width="2" transform="translate(-10000 -10000)"></polygon>',r+="</g>",r+="</svg>",o.html(r);var i,l,s,c,m,d,u,f,h,p,g,x,v,b,M,F=n.find(".ping-marker.center"),E=n.find(".ping-marker.accent"),_=n.find(".ping-marker.vertical"),S=n.find(".ping-marker.horizontal"),k=n.find(".ping-marker.other-floor"),I=(M=t,function(e){var n=P(e.target).closest(".map-container"),t=C(e.center.x,e.center.y,n),o=t.x,a=t.y,r=n.attr("show-floor-index");T(p,g,x,v,b,o+M.LEFT_OFFSET,a+M.TOP_OFFSET,r)}),w=function(){var e=P(f[0]).panzoom("getMatrix")[0],n=Math.round(PING_MARKER_RADIUS/e),n=Math.max(MIN_PING_MARKER_RADIUS,n),n=Math.min(MAX_PING_MARKER_RADIUS,n),t=Math.max(MIN_PING_MARKER_BORDER,Math.floor(n*PING_MARKER_BORDER_PERCENT));n-=t,d.attr("r",n),u.attr("r",2*n),d.attr("stroke-width",t),h.attr("stroke-width",t)},y=(i=d=p=F,l=u=g=E,s=x=_,c=v=S,m=h=b=k,function(){T(i,l,s,c,m,-1e4,-1e4)});(f=e).each(function(e,n){var t=new Hammer(n);t.on("press",I),t.on("tap",I)}),F.on("click",y),e.on("panzoomzoom",w),w()},refreshPings:function(){refreshPings()}}}(window.jQuery,(window,document));!function(o,a,r,i,l,s,c,n){var u,m,d,f,h,p,g,t,x,v="show-map",b="show-map-selection-grid",M="/";o(function(){e();l.createMapPanels(m,4);F();E();_();s.createMapCombo(i.getMapData());S();k();s.setPanZoom(d,f);if(te()){I();oe();Y()}else{q();r.title="R6Calls.com"}setTimeout(function(){t.removeClass("loading")},10)});var e=function e(){m=o("#map-panels-container");g=o("#nav-logo");t=o("body");x=o("#main-nav")},F=function e(){u=o(".map-container");d=u.find(".map-main");f=d.find(".map-elements");h=o(".map-panel-label");p=d.find(".svg-wrapper.drawing-markers")},E=function e(){var n=o("#mmenu-link");s.getMenuHTML();o("#mmenu-menu").mmenu({offCanvas:{position:"right",pageSelector:"#mmenu-page"},extensions:["pagedim"],rtl:{use:false}});n.click(B)},_=function e(){n.createMapSelectionGrid(o("#map-selection-grid"),o("#map-selection-heading"),x,i.getMapData(),X,J)},S=function e(){s.setMapChangeEvent(G);s.setFloorsChangeEventAndHotkeys(O,Q);s.setMapPanelsCountChangeEvent(L);s.MAP_LAYERS.forEach(function(e){s.setMenuCheckboxChangeEvent(e.short,W)});s.setMenuCheckboxChangeEvent("lfa",Z);s.setMenuSelectMapClickEvent(q,R);s.setMenuFullScreenClickEvent();o(a).on("orientationchange",function(){s.resetPan(d,U);s.resetZoom(d,U)});g.on("click",$)},k=function e(){ne();s.MAP_LAYERS.forEach(function(e){ee(e.short)});ee("lfa")},I=function e(){var n=s.getSelectedMap(),t=i.getMapData();s.getFloorButtonsHTML(t[n].floors);l.getMapHTML(t[n],f,h);s.resetPan(d,U);s.resetZoom(d,U);Q();K(n);g.addClass("enabled");re();var o=r.getElementsByClassName("svgMap"),a;for(a=0;a<o.length;a++){o[a].onload=function(){w();y();P();C()}}c.setupMarkers(d,p,l.SVG_DIM)},w=function e(){s.setMapsPositionAndSize()},y=function e(){s.MAP_LAYERS.forEach(function(e){s.setLayerDisplay(e.short)})},P=function e(){s.setFoorDisplay(s.getSelectedFloor())},C=function e(){s.removeHidden()},T=function e(){return t.attr("loaded-map")},R=function e(){D().close()},A=function e(){return t.hasClass(v)},H=function e(){return a.location.hash.substr(1).split(M)},N=function e(){return o("body").attr("loaded-map")},D=function e(){return o("#mmenu-menu").data("mmenu")},U=function e(){var n={topLeft:{top:-180,left:-312},bottomRight:{top:180,left:312}};var t=n.bottomRight.left-n.topLeft.left,o=n.bottomRight.top-n.topLeft.top,a=Math.round(n.bottomRight.top-o/2),r=Math.round(n.topLeft.left+t/2),i=u.width(),l=u.height(),s=x.height(),c=Math.min(l*.1,s),m=Math.min(l*.1,s*2);i=i-c;l=l-m;var d={debugZoomWidth:t,debugZoomHeight:o,centerTop:a,centerLeft:r,debugPanelWidth:i,debugPanelHeight:l,debugPaddingWidth:c,debugPaddingHeight:m,zoomValue:Math.max(Math.min(1,i/t,l/o),.5)};return d},O=function e(){Q();ae();c.refreshPings()},G=function e(){I();ae()},L=function e(n){j(n);P()},B=function e(n){var t=D();n.preventDefault();t.open()},z=function e(n,t){try{localStorage.setItem(n,t)}catch(e){}},V=function e(){var n,t,o=a.location;if("pushState"in history){history.pushState("",r.title,o.pathname+o.search)}else{n=r.body.scrollTop;t=r.body.scrollLeft;o.hash="";r.body.scrollTop=n;r.body.scrollLeft=t}},W=function e(n,t){z(n,t)},Z=function e(n,t){z(n,t);if(t){s.resetPan(d,U)}},K=function e(n){t.attr("loaded-map",n)},j=function e(t){z("mappanelscount",t);m.attr("map-panels-count",t);o.each(d,function(e,n){if(e<t){o(n).css("display","block");s.enableZoom(o(n))}else{o(n).css("display","none");s.disableZoom(o(n))}});s.resetPan(d,U);s.resetZoom(d,U);Q()},q=function e(){t.removeClass(v);t.addClass(b);ae();re()},Y=function e(){t.removeClass(b);t.addClass(v);ae();re()},Q=function e(){var n=s.getMinMaxFloor();l.showFloor(s.getSelectedFloor(),m,u,n.min,n.max)},X=function e(n){if(s.setSelectedMap(n)){J();setTimeout(function(){I();Y()},1)}},$=function e(n){var t=D();n.preventDefault();if(A()){q();t.close()}else if(T()){Y();t.close()}},J=function e(){if(T()){Y()}},ee=function e(n){var t=localStorage.getItem(n);if(t!==null){s.setMenuCheckboxOption(n,t)}},ne=function e(){var n=localStorage.getItem("mappanelscount");if(!n){var t=o(a);n=t.width()>1e3||t.height()>1e3?2:1}s.setSelectedMapPanel(n);j(n)},te=function e(){var n=H(),t=n[0];return s.setSelectedMap(t)},oe=function e(){var n=H(),t=n[1];if(s.setSelectedFloor(t)){Q()}},ae=function e(){if(A()){var n="";n+=""+s.getSelectedMap();n+=M+s.getSelectedFloor();a.location.hash=n}else{V()}},re=function e(){r.title=A()?"R6Calls.com - {mapName}".replace("{mapName}",i.getMapData()[N()].name):"R6Calls.com - Select a map"}}(window.jQuery,window,document,R6MMainData,R6MMainRender,R6MMainControls,R6MMainDrawing,R6MMainMapSelectionGrid);
//# sourceMappingURL=main.min.js.map